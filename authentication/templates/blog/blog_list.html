{% extends 'authentication/posts.html' %}
{% load static %}
{% include 'blog/navbar.html' with profile_pic=navbar_context.profile_pic name=navbar_context.name %}
{% block allblogs %}
<style>
body {
        background-image: url("{% static 'authentication/images/xandtor-vmKczlvO12A-unsplash.jpg' %}");
        background-repeat: no-repeat;
        background-size: cover;
        /* Add more CSS styles as needed */
    }
    pre {
        background-color: #f4f4f4;
        border: 1px solid #ddd;
        padding: 10px;
        white-space: pre-wrap;
    }

    code {
        display: block;
        font-family: "Courier New", Courier, monospace;
        font-size: 14px;
    }
</style>

<!-- Content specific to the template extending posts.html -->
<div class="dropdown" style="text-align: center; margin-top:8%; width:30%; height:10%; margin-left:35%; border-radius:None">
    <form method="POST" action="{% url 'blog_list' %}">
        {% csrf_token %}
        <select name="category">
            <option value="all" {% if selected_category == 'all' %}selected{% endif %}>All Blogs</option>

            {% for category in categories %}
                <option value="{{ category }}" {% if category == selected_category %}selected{% endif %}>{{ category }}</option>
            {% endfor %}
        </select>
        <button class="search-button" type="submit">Search</button>
    </form>
    {% if message %}
        <p>{{ message }}</p>
    {% endif %}
</div>
<div class="container">
    <div class="row">
        {% for blog in blogs %}
            <div class="col-6 offset-2">
                <div class="card">
                    <div class="image-container">
                        {% if blog.image %}
                            <img src="{{ blog.image.url }}" alt="...">
                        {% endif %}
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">{{ blog.title }}</h5>
                        <p class="card-text">{{ blog.content|truncatewords:20 }}</p>
                            


                        <a href="{% url 'blog_detail' blog_id=blog.id %}" class="btn btn-primary" style="margin-left:43%; border-color:blue">Read More</a>
                    </div>
                    <div class="card-footer footer">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <form id="likeForm" method="POST" action="{% url 'like_blog' blog.id %}" class="like-form">
                                    {% csrf_token %}
                                    <input type="hidden" name="blog_id" value="">
                                    <span style="color:black; margin-left:23px" id="likeCount" class="like-count">{{ blog.likes.count }}</span>
                                    <button type="submit" class="like-button" id="likeButton"><i class="bi bi-heart"></i></button>
                                </form>
                            </div>
                            <small class="text-muted" id="datePosted">{{ blog.date_posted }}</small>
                            <small class="text-muted" id="timePosted">{{ blog.time_posted }}</small>
                            <div class="user-profile">
                                <span style="margin-left:80px;padding-left: 30px; color:black">Posted By: {{ blog.user.username }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}